{% extends 'base.html' %}
{% block title %}COVID-19 Prediction{% endblock %}
{% block content %}
<div class="card p-4 shadow-lg" style="width: 100%; max-width: 700px; margin: auto;">
    <h2 class="text-center mb-4">COVID-19 Prediction</h2>
    
    <div class="alert alert-info mb-4">
        <strong>Note:</strong> This tool is for informational purposes only. It does not replace professional medical advice. If you are experiencing severe symptoms, please consult a healthcare provider.
    </div>

    <form method="POST">
        {% csrf_token %}
        
        <!-- Common Symptoms Section -->
        <div class="row">
            <div class="col-md-6">
                <h4>Common Symptoms</h4>
                <div class="mb-3">
                    {{ form.none_symptom.label_tag }}
                    {{ form.none_symptom }}
                    <br><small class="form-text text-muted">Select if you have none of these symptoms.</small>
                </div>
                <div class="mb-3">
                    {{ form.tiredness.label_tag }}
                    {{ form.tiredness }}
                    <br><small class="form-text text-muted">Feeling unusually tired or weak.</small>
                </div>
                <div class="mb-3">
                    {{ form.dry_cough.label_tag }}
                    {{ form.dry_cough }}
                    <br><small class="form-text text-muted">A dry cough without mucus.</small>
                </div>
                <div class="mb-3">
                    {{ form.difficulty_in_breathing.label_tag }}
                    {{ form.difficulty_in_breathing }}
                    <br><small class="form-text text-muted">Trouble breathing or shortness of breath.</small>
                </div>
                <div class="mb-3">
                    {{ form.sore_throat.label_tag }}
                    {{ form.sore_throat }}
                    <br><small class="form-text text-muted">Pain or irritation in the throat.</small>
                </div>
            </div>

            <!-- Less Common Symptoms Section -->
            <div class="col-md-6">
                <h4>Less Common Symptoms</h4>
                <div class="mb-3">
                    {{ form.fever.label_tag }}
                    {{ form.fever }}
                    <br><small class="form-text text-muted">A temperature above 100°F (37.8°C).</small>
                </div>
                <div class="mb-3">
                    {{ form.pains.label_tag }}
                    {{ form.pains }}
                    <br><small class="form-text text-muted">General aches or pains in your body.</small>
                </div>
                <div class="mb-3">
                    {{ form.nasal_congestion.label_tag }}
                    {{ form.nasal_congestion }}
                    <br><small class="form-text text-muted">Blockage or stuffiness in your nose.</small>
                </div>
                <div class="mb-3">
                    {{ form.runny_nose.label_tag }}
                    {{ form.runny_nose }}
                    <br><small class="form-text text-muted">Continuous dripping of mucus from the nose.</small>
                </div>
                <div class="mb-3">
                    {{ form.diarrhea.label_tag }}
                    {{ form.diarrhea }}
                    <br><small class="form-text text-muted">Frequent loose or watery stools.</small>
                </div>
            </div>
        </div>

        <!-- Submit Button -->
        <div class="d-grid mt-3">
            <button type="submit" class="btn btn-primary" id="predict-button">Predict</button>
        </div>
    </form>

    <!-- Loading Spinner (Optional) -->
    <div id="loading-spinner" class="d-none mt-3 text-center">
        <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Loading...</span>
        </div>
    </div>

    <!-- Modal for Prediction Result -->
    {% if prediction %}
        <div class="modal fade" id="predictionResultModal" tabindex="-1" aria-labelledby="predictionResultModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="predictionResultModalLabel">Prediction Result</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <h5>Symptoms Checked:</h5>
                        <ul>
                            {% if form.tiredness.value %}
                                <li>Tiredness</li>
                            {% endif %}
                            {% if form.dry_cough.value %}
                                <li>Dry Cough</li>
                            {% endif %}
                            {% if form.difficulty_in_breathing.value %}
                                <li>Difficulty in Breathing</li>
                            {% endif %}
                            {% if form.sore_throat.value %}
                                <li>Sore Throat</li>
                            {% endif %}
                            {% if form.fever.value %}
                                <li>Fever</li>
                            {% endif %}
                            {% if form.pains.value %}
                                <li>Pains</li>
                            {% endif %}
                            {% if form.nasal_congestion.value %}
                                <li>Nasal Congestion</li>
                            {% endif %}
                            {% if form.runny_nose.value %}
                                <li>Runny Nose</li>
                            {% endif %}
                            {% if form.diarrhea.value %}
                                <li>Diarrhea</li>
                            {% endif %}
                        </ul>
                        <h5>Prediction Result:</h5>
                        <p>{{ prediction }}</p>
                    </div>
                    <div class="modal-footer">
                        <a href="{% url 'predict' %}" class="btn btn-primary">Predict Again</a>
                    </div>
                </div>
            </div>
        </div>
        <script>
            // Wait for the DOM to be ready
            document.addEventListener("DOMContentLoaded", function() {
                var predictionModal = new bootstrap.Modal(document.getElementById('predictionResultModal'));
                predictionModal.show(); // Show the modal
            });
        </script>
    {% endif %}
</div>

{% endblock %}
